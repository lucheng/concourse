<?xml version="1.0" encoding="UTF-8"?>  
<beans:beans xmlns="http://www.springframework.org/schema/security"  
    xmlns:beans="http://www.springframework.org/schema/beans"  
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">  
                          
    <global-method-security pre-post-annotations="enabled" />   
    <!-- 该路径下的资源不用过滤 --> 
    <http pattern="/js/**" security="none"/>
    <http pattern="/css/**" security="none"/>
    <http pattern="/images/**" security="none"/>
    <http pattern="/upload/**" security="none"/>

    <http auto-config="true">
	    <!-- Authentication policy --> 
	    <form-login login-page="/manage/login" login-processing-url="/j_spring_security_check" default-target-url="/manage/index" authentication-failure-url="/manage/login?login_error=1"/>
	    <logout logout-url="/manage/logout" logout-success-url="/users/logoutSuccess"/>
	    <intercept-url pattern="/static/**" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
	    <intercept-url pattern="/manage/login" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
	    <intercept-url pattern="/manage/logoutSuccess" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
	    <intercept-url pattern="/**" access="ROLE_USER" />
	</http>
	 
	<authentication-manager>
	    <authentication-provider>
			<user-service>
	        	<user name="admin" password="admin" authorities="ROLE_USER, ROLE_ADMIN" />
	        	<user name="user" password="user" authorities="ROLE_USER" />
			</user-service>
	    </authentication-provider>
	</authentication-manager>
    
    <!-- 配置过滤器 -->  
    <!--<beans:bean id="myFilter" class="edu.bupt.spring.web.security.MySecurityFilter">  
         用户拥有的权限   
        <beans:property name="authenticationManager" ref="myAuthenticationManager" />  
         用户是否拥有所请求资源的权限   
        <beans:property name="accessDecisionManager" ref="myAccessDecisionManager" />  
         资源与权限对应关系   
        <beans:property name="securityMetadataSource" ref="mySecurityMetadataSource" />  
    </beans:bean>
    
     实现了UserDetailsService的Bean   
    <authentication-manager alias="myAuthenticationManager">  
        <authentication-provider user-service-ref="myUserDetailServiceImpl" />  
    </authentication-manager>
    
    <beans:bean id="myAccessDecisionManager" class="edu.bupt.spring.web.security.MyAccessDecisionManager">
    </beans:bean>
    
    <beans:bean id="mySecurityMetadataSource" class="edu.bupt.spring.web.security.MySecurityMetadataSource">  
        <beans:constructor-arg name="resourceService" ref="resourceServiceImpl"></beans:constructor-arg>  
    </beans:bean>
    
    <beans:bean id="myUserDetailServiceImpl" class="edu.bupt.spring.web.security.MyUserDetailServiceImpl">  
        <beans:property name="adminService" ref="userServiceImpl"></beans:property>  
    </beans:bean>
    
    <beans:bean id="userServiceImpl" class="edu.bupt.spring.service.impl.UserServiceImpl">  
    </beans:bean>
    
    <beans:bean id="resourceServiceImpl" class="edu.bupt.spring.service.impl.ResourceServiceImpl">  
    </beans:bean>
-->
</beans:beans> 